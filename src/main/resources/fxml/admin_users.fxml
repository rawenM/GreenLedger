<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>

<BorderPane xmlns="http://javafx.com/javafx"
            xmlns:fx="http://javafx.com/fxml"
            fx:controller="Controllers.AdminUsersController"
            stylesheets="@../css/style.css">

    <!-- TOP: Header avec statistiques -->
    <top>
        <VBox style="-fx-background-color: #1F2937; -fx-padding: 20;">
            <HBox alignment="CENTER_LEFT" spacing="20">
                <padding>
                    <Insets left="20" right="20"/>
                </padding>

                <Label text="Gestion des Utilisateurs"
                       style="-fx-text-fill: white; -fx-font-size: 24px; -fx-font-weight: bold;"/>

                <Region HBox.hgrow="ALWAYS"/>

                <Label fx:id="currentUserLabel"
                       style="-fx-text-fill: white; -fx-font-size: 14px;"/>

                <Button text="DÃ©connexion"
                        styleClass="button-danger"
                        onAction="#handleLogout"/>
            </HBox>

            <!-- Statistiques -->
            <HBox spacing="20" style="-fx-padding: 20 0 0 0;">
                <padding>
                    <Insets left="20" right="20"/>
                </padding>

                <!-- Total -->
                <VBox alignment="CENTER" styleClass="card" spacing="5"
                      style="-fx-background-color: white; -fx-padding: 15;">
                    <Label text="Total Utilisateurs" style="-fx-text-fill: #6B7280;"/>
                    <Label fx:id="totalUsersLabel" text="0"
                           style="-fx-font-size: 28px; -fx-font-weight: bold; -fx-text-fill: #2563EB;"/>
                </VBox>

                <!-- Actifs -->
                <VBox alignment="CENTER" styleClass="card" spacing="5"
                      style="-fx-background-color: white; -fx-padding: 15;">
                    <Label text="Actifs" style="-fx-text-fill: #6B7280;"/>
                    <Label fx:id="activeUsersLabel" text="0"
                           style="-fx-font-size: 28px; -fx-font-weight: bold; -fx-text-fill: #10B981;"/>
                </VBox>

                <!-- En attente -->
                <VBox alignment="CENTER" styleClass="card" spacing="5"
                      style="-fx-background-color: white; -fx-padding: 15;">
                    <Label text="En Attente" style="-fx-text-fill: #6B7280;"/>
                    <Label fx:id="pendingUsersLabel" text="0"
                           style="-fx-font-size: 28px; -fx-font-weight: bold; -fx-text-fill: #F59E0B;"/>
                </VBox>

                <!-- BloquÃ©s -->
                <VBox alignment="CENTER" styleClass="card" spacing="5"
                      style="-fx-background-color: white; -fx-padding: 15;">
                    <Label text="BloquÃ©s" style="-fx-text-fill: #6B7280;"/>
                    <Label fx:id="blockedUsersLabel" text="0"
                           style="-fx-font-size: 28px; -fx-font-weight: bold; -fx-text-fill: #EF4444;"/>
                </VBox>
            </HBox>
        </VBox>
    </top>

    <!-- CENTER: Table et filtres -->
    <center>
        <VBox spacing="15" style="-fx-padding: 20;">

            <!-- Barre de recherche et filtres -->
            <HBox spacing="15" alignment="CENTER_LEFT">
                <TextField fx:id="searchField"
                           promptText="Rechercher par nom, email, tÃ©lÃ©phone..."
                           prefWidth="300"
                           onKeyReleased="#handleSearch"/>

                <ComboBox fx:id="filterStatutCombo"
                          promptText="Filtrer par statut"
                          onAction="#handleSearch"
                          prefWidth="150"/>

                <ComboBox fx:id="filterTypeCombo"
                          promptText="Filtrer par type"
                          onAction="#handleSearch"
                          prefWidth="150"/>

                <Region HBox.hgrow="ALWAYS"/>

                <Button text="ðŸ”„ Actualiser"
                        styleClass="button-secondary"
                        onAction="#handleRefresh"/>

                <Button text="âž• Nouvel utilisateur"
                        onAction="#handleAddUser"/>
            </HBox>

            <!-- Table des utilisateurs -->
            <TableView fx:id="usersTable" VBox.vgrow="ALWAYS">
                <columns>
                    <TableColumn fx:id="idColumn" text="ID" prefWidth="60"/>
                    <TableColumn fx:id="nomColumn" text="Nom" prefWidth="120"/>
                    <TableColumn fx:id="prenomColumn" text="PrÃ©nom" prefWidth="120"/>
                    <TableColumn fx:id="emailColumn" text="Email" prefWidth="200"/>
                    <TableColumn fx:id="telephoneColumn" text="TÃ©lÃ©phone" prefWidth="120"/>
                    <TableColumn fx:id="typeColumn" text="Type" prefWidth="130"/>
                    <TableColumn fx:id="statutColumn" text="Statut" prefWidth="120"/>
                    <TableColumn fx:id="dateInscriptionColumn" text="Date Inscription" prefWidth="150"/>
                    <TableColumn fx:id="actionsColumn" text="Actions" prefWidth="150"/>
                </columns>
            </TableView>
        </VBox>
    </center>
</BorderPane>